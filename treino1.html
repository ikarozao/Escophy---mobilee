<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Treinos | Escorphy</title>

    <link rel="stylesheet" href="treinos/treinos.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-sA+e2GPr+T3z3aQmc6ctFfgkZ4p4O4FfX3JfQ3xXNDs=" crossorigin="" />
    
    <link rel="icon" type="image/png" href="img/a.png">
</head>

<body>

    <nav>
        <a href="home.html" class="bar_n" style="text-decoration:none; color:black; cursor:pointer;">Escorphy</a>
        <div class="nav-right">
            <div class="search-box">
                <input class="input-rounded" type="text" placeholder="Pesquisar..." />
            </div>
        </div>
    </nav>

    <div class="treinos">
        <div class="cima">
            <h1>Registre seu treino!</h1>
        </div>

        <div class="carousel-wrapper">
            <button class="arrow left" onclick="moverEsquerda()">‚ùÆ</button>

            <div class="carousel">
                <div class="icon-container" id="carouselContainer">
                    <div onclick="mostrarFormulario()" class="circle"><img src="img/image.png" alt="√çcone Corrida" /></div>
                    <div onclick="mostrarFormulario()" class="circle"><img src="img/bike copy.png" alt="√çcone Bicicleta" /></div>
                    <div onclick="mostrarFormulario()" class="circle"><img src="img/run.png" alt="√çcone Muscula√ß√£o" /></div>
                    <div onclick="mostrarFormulario()" class="circle"><img src="img/dumbbell.png" alt="√çcone Yoga" /></div>
                    <div onclick="mostrarFormulario()" class="circle"><img src="img/exercise.png" alt="√çcone Nata√ß√£o" /></div>
                    <div onclick="mostrarFormulario()" class="circle"><img src="img/hiking.png" alt="√çcone Caminhada" /></div>
                </div>
            </div>

            <button class="arrow right" onclick="moverDireita()">‚ùØ</button>
        </div>

        <div id="map"></div>

        <article id="infos_treinos" class="infos_treinos" style="display: none;">

            <h1>Informa√ß√µes da atividade</h1>

            <div class="titulo">
                <p>T√≠tulo do treino:</p>
                <input class="input-rounded" type="text" name="titulo" placeholder="" required>
            </div>

            <div class="descricao">
                <p>Descri√ß√£o do treino:</p>
                <input class="input-rounded" type="text" name="descricao" placeholder="" required>
            </div>

            <div class="grupo-opcoes">
                <p>Tipo de treino:</p>
                <div class="tipo">
                    <a href="#" role="menuitem" tabindex="0">Treino</a>
                    <a href="#" role="menuitem" tabindex="0">Prova</a>
                    <a href="#" role="menuitem" tabindex="0">Long√£o</a>
                </div>
            </div>

            <div class="grupo-opcoes"> 
                <p>N√≠vel de intensidade</p>
                <div class="range-container">
                    <input type="range" class="rangezao" min="1" max="10" step="1">
                    <div class="rangezi">
                        <span class="tooltip">1<span class="tip">Pouco</span></span>
                        <span>2</span><span>3</span><span>4</span>
                        <span class="tooltip">5<span class="tip">M√©dio</span></span>
                        <span>6</span><span>7</span><span>8</span><span>9</span>
                        <span class="tooltip">10<span class="tip">Muito</span></span>
                    </div>
                </div>
            </div>

            <div class="grupo-opcoes">
                <p>Visibilidade do Treino:</p>
                <div class="visibilidade">
                    <a href="#" role="menuitem" tabindex="0">Privado</a>
                    <a href="#" role="menuitem" tabindex="0">P√∫blico</a>
                </div>
            </div>

            <div class="grupo-opcoes">
                <p>Adicione o tipo de acess√≥rio:</p>
                <div class="acessorio">
                    <a href="#" class="acessorio-option" role="menuitem" tabindex="0">Rel√≥gio</a>
                    <a href="#" class="acessorio-option" role="menuitem" tabindex="0">Fones</a>
                    <a href="#" class="acessorio-option" role="menuitem" tabindex="0">Pulseira</a>
                </div>

                <div class="acessorio-specs">
                    <p>Especifica√ß√µes dos acess√≥rios:</p>
                    <input type="text" id="especificacoesAcessorios" placeholder="Ex: Marca, modelo, cor, tipo de pisada, etc.">
                </div>
            </div>

            <div class="botao-salvar">
                <button id="salvarBtn">Salvar</button>
            </div>

            <div id="mensagemSalvo" class="mensagem-flutuante">
                Salvo com sucesso!
            </div>

        </article>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-sA+e2GPr+T3z3aQmc6ctFfgkZ4p4O4FfX3JfQ3xXNDs=" crossorigin=""></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            function setupSingleSelection(containerSelector) {
                const container = document.querySelector(containerSelector);
                if (!container) return;

                const links = container.querySelectorAll('a');
                links.forEach(link => {
                    link.addEventListener('click', e => {
                        e.preventDefault();
                        links.forEach(l => l.classList.remove('active-option'));
                        link.classList.add('active-option');
                    });
                });
            }

            setupSingleSelection('.tipo');
            setupSingleSelection('.visibilidade');

            const accessoryOptions = document.querySelectorAll('.acessorio .acessorio-option');
            const acessorioSpecsContainer = document.querySelector('.acessorio-specs');
            const especificacoesAcessoriosInput = document.getElementById('especificacoesAcessorios');

            function toggleAcessorioSpecsVisibility() {
                let anyAccessorySelected = false;
                accessoryOptions.forEach(option => {
                    if (option.classList.contains('active-option')) {
                        anyAccessorySelected = true;
                    }
                });

                if (anyAccessorySelected) {
                    acessorioSpecsContainer.style.display = 'flex';
                    acessorioSpecsContainer.offsetHeight;
                    acessorioSpecsContainer.style.opacity = '1';
                    acessorioSpecsContainer.style.height = 'auto';
                } else {
                    acessorioSpecsContainer.style.opacity = '0';
                    acessorioSpecsContainer.style.height = '0';
                    especificacoesAcessoriosInput.value = '';
                    setTimeout(() => {
                        acessorioSpecsContainer.style.display = 'none';
                    }, 300);
                }
            }

            accessoryOptions.forEach(option => {
                option.addEventListener('click', function (event) {
                    event.preventDefault();
                    this.classList.toggle('active-option');
                    toggleAcessorioSpecsVisibility();
                });
            });

            toggleAcessorioSpecsVisibility();

            const circles = document.querySelectorAll('.circle');
            circles.forEach(circle => {
                circle.addEventListener('click', () => {
                    circles.forEach(c => {
                        c.classList.remove('active');
                        c.style.animation = 'none';
                        c.offsetHeight;
                        c.style.animation = null;
                    });
                    circle.classList.add('active');
                });
            });

            window.mostrarFormulario = function () {
                const form = document.getElementById("infos_treinos");
                form.style.display = form.style.display === "none" ? "block" : "none";
            }

            const salvarBtn = document.getElementById('salvarBtn');
            const mensagemSalvo = document.getElementById('mensagemSalvo');

            salvarBtn.addEventListener('click', () => {
                mensagemSalvo.classList.add('show');
                setTimeout(() => {
                    mensagemSalvo.classList.remove('show');
                }, 2000);
            });

            const map = L.map('map').setView([-23.55052, -46.633308], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap',
            }).addTo(map);

            L.marker([-23.55052, -46.633308])
                .addTo(map)
                .bindPopup('Voc√™ est√° aqui.')
                .openPopup();
        });

        
       /* let posicao = 0;
  const container = document.getElementById("carouselContainer");
  const circles = document.querySelectorAll(".circle");
  const totalItens = circles.length;
  const larguraItem = 140; // largura + gap aproximado
  const maxPosicao = totalItens - 3; // exibe 3 por vez

  function moverDireita() {
    if (posicao < maxPosicao) {
      posicao++;
      atualizarCarrossel();
    }
  }

  function moverEsquerda() {
    if (posicao > 0) {
      posicao--;
      atualizarCarrossel();
    }
  }

  function atualizarCarrossel() {
    const deslocamento = -(posicao * larguraItem);
    container.style.transform = translateX(${deslocamento}px);
  }

  function mostrarFormulario() {
    document.querySelector(".infos_treinos")?.scrollIntoView({ behavior: 'smooth' });
  }

  // Ativa√ß√£o visual dos c√≠rculos
  document.querySelectorAll(".circle").forEach(circle => {
    circle.addEventListener("click", function () {
      document.querySelectorAll(".circle").forEach(c => c.classList.remove("active"));
      this.classList.add("active");
    });
  });*/

  //rota

  


    </script>
    <!-- Leaflet CSS -->
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
  // Inicializa o mapa
  const map = L.map('map').setView([-24.740387, -53.767403], 16); 

  

  // Recupera rota salva no localStorage (ou array vazio se n√£o existir)
  let route = JSON.parse(localStorage.getItem("route")) || [];

  // Adiciona polyline e marcador
  let polyline = L.polyline(route, { color: 'red' }).addTo(map);
  let marker = null;

  // Se j√° havia rota, posiciona o marcador no √∫ltimo ponto
  if (route.length > 0) {
    const lastPoint = route[route.length - 1];
    marker = L.marker(lastPoint).addTo(map);
    map.setView(lastPoint, 15);
  }

  // Rastrear localiza√ß√£o em tempo real
  navigator.geolocation.watchPosition(
    (pos) => {
      const lat = pos.coords.latitude;
      const lng = pos.coords.longitude;

      // Adiciona novo ponto
      route.push([lat, lng]);

      // Salva no localStorage
      localStorage.setItem("route", JSON.stringify(route));

      // Atualiza polyline
      polyline.setLatLngs(route);

      // Atualiza marcador
      if (!marker) {
        marker = L.marker([lat, lng]).addTo(map);
      } else {
        marker.setLatLng([lat, lng]);
      }

      // Centraliza s√≥ na primeira posi√ß√£o detectada
      if (route.length === 1) {
        map.setView([lat, lng], 15);
      }
    },
    (err) => console.error(err),
    { enableHighAccuracy: true }
  );

  // Fun√ß√£o para limpar rota
  function resetRoute() {
    route = [];
    localStorage.removeItem("route");
    polyline.setLatLngs([]);
    if (marker) {
      map.removeLayer(marker);
      marker = null;
    }
  }

  // Criar bot√£o no mapa para limpar a rota
  const clearControl = L.Control.extend({
    options: { position: 'topright' },
    onAdd: function () {
      const container = L.DomUtil.create('div', 'leaflet-bar leaflet-control leaflet-control-custom');
      container.style.backgroundColor = 'white';
      container.style.width = '100px';
      container.style.height = '30px';
      container.style.lineHeight = '30px';
      container.style.textAlign = 'center';
      container.style.cursor = 'pointer';
      container.style.fontWeight = 'bold';
      container.title = 'Limpar rota';
      container.innerHTML = 'Limpar Rota';

      container.onclick = function () {
        if (confirm('Tem certeza que quer limpar a rota?')) {
          resetRoute();
        }
      };

      // Evita que o clique atrapalhe o mapa
      L.DomEvent.disableClickPropagation(container);

      return container;
    }
  });

  map.addControl(new clearControl());



  navigator.geolocation.watchPosition(
  (pos) => {
    const lat = pos.coords.latitude;
    const lng = pos.coords.longitude;
    const accuracy = pos.coords.accuracy; // em metros

    // Ignora pontos ruins
    if (accuracy > 30) {
      console.log("Ponto descartado (precis√£o baixa):", accuracy);
      return;
    }

    let newPoint = [lat, lng];

    // üî• Suaviza√ß√£o (m√©dia m√≥vel com √∫ltimos 2 pontos)
    if (route.length >= 2) {
      const p1 = route[route.length - 1];
      const p2 = route[route.length - 2];
      newPoint = [
        (p1[0] + p2[0] + lat) / 3,
        (p1[1] + p2[1] + lng) / 3
      ];
    }

    // Ignora varia√ß√µes pequenas (ex: < 5m)
    if (lastPoint) {
      const dist = haversine(lastPoint, newPoint);
      if (dist < 5) return;
      totalDistance += dist;
    }

    lastPoint = newPoint;
    route.push(newPoint);

    // Salva rota
    localStorage.setItem("route", JSON.stringify(route));

    // Atualiza polyline
    polyline.setLatLngs(route);

    // Atualiza marcador
    if (!marker) {
      marker = L.marker(newPoint).addTo(map);
    } else {
      marker.setLatLng(newPoint);
    }

    // Atualiza estat√≠sticas
    const speed = pos.coords.speed ? pos.coords.speed * 3.6 : 0;
    updateStats(speed);

    // Centraliza na primeira posi√ß√£o
    if (route.length === 1) {
      map.setView(newPoint, 17);
    }
  },
  (err) => console.error(err),
  { enableHighAccuracy: true, maximumAge: 0, timeout: 5000 }
);





  // Adiciona o tile do OpenStreetMap
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution:
      '¬© <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
  }).addTo(map);

 
</script>

    
<footer class="footer">
    <div class="footer-container">
      <div class="footer-logo">
        <h1>ESCORPHY</h1>
        <p>¬© 2025 Escorphy</p>
      </div>

      <div class="footer-column">
        <h3>Sobre</h3>
        <ul>
          <li><a href="sobrenos.html">Nossa Hist√≥ria</a></li>
          <li><a href="sobrenos.html">Miss√£o</a></li>
          <li><a href="sobrenos.html">Equipe</a></li>
          <li><a href="#">Privacidade</a></li>
        </ul>
      </div>

      <div class="footer-column">
        <h3>Explorar</h3>
        <ul>
          <li><a href="#">Funcionalidades</a></li>
          <li><a href="#">Planos</a></li>
          <li><a href="#">Blog</a></li>
        </ul>
      </div>

      <div class="footer-column">
        <h3>Redes</h3>
        <ul class="social-icons">
          <li><a href="https://www.instagram.com/escorphy"><i class="fab fa-instagram"></i> Instagram</a></li>
          <li><a href="https://www.youtube.com/escorphy"><i class="fab fa-youtube"></i> YouTube</a></li>

        </ul>
      </div>

      <div class="footer-column">
        <h3>Ajuda</h3>
        <ul>
          <li><a href="#">Suporte</a></li>
          <li><a href="#">Fale Conosco</a></li>
          <li><a href="#">Central de Ajuda</a></li>
        </ul>
      </div>
    </div>
  </footer>
</body>

</html>